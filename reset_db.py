#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
–°–∫—Ä–∏–ø—Ç –¥–ª—è –æ–±–Ω—É–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î, –Ω–µ —Ç—Ä–æ–≥–∞—è —Ñ–∞–π–ª –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É:
- —É–¥–∞–ª—è–µ—Ç –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏;
- –æ–±–Ω—É–ª—è–µ—Ç –±–∞–ª–∞–Ω—Å—ã;
- —á–∞—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è;
- –ø–æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ—Ç –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç –¥–ª—è operations.
"""

from database import Database


def reset_db():
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ë–î (—Å–æ–∑–¥–∞—Å—Ç —Ç–∞–±–ª–∏—Ü—ã, –µ—Å–ª–∏ –∏—Ö –Ω–µ—Ç)
    db = Database()
    conn = db.get_connection()
    cur = conn.cursor()

    print("üßπ –û—á–∏—â–∞—é —Ç–∞–±–ª–∏—Ü—É operations (–≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏)...")
    try:
        cur.execute("DELETE FROM operations;")
    except Exception as e:
        print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—á–∏—Å—Ç–∏—Ç—å operations: {e}")

    print("üßπ –û–±–Ω—É–ª—è—é –±–∞–ª–∞–Ω—Å—ã (balances)...")
    try:
        # –û–±–Ω—É–ª—è–µ–º —Å—É–º–º—ã, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç—Ä–æ–∫–∏ –∏ —Å–≤—è–∑–∏ —Å —á–∞—Ç–∞–º–∏
        cur.execute("""
            UPDATE balances
            SET balance = 0.0,
                last_updated = CURRENT_TIMESTAMP;
        """)
    except Exception as e:
        print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ–±–Ω—É–ª–∏—Ç—å balances: {e}")

    # –ï—Å–ª–∏ —Ö–æ—á–µ—à—å —Ç–∞–∫–∂–µ —É–¥–∞–ª–∏—Ç—å –≤—Å–µ —á–∞—Ç—ã ‚Äî —Ä–∞—Å–∫–æ–º–º–µ–Ω—Ç–∏—Ä—É–π –±–ª–æ–∫ –Ω–∏–∂–µ
    # print("üßπ –û—á–∏—â–∞—é —Ç–∞–±–ª–∏—Ü—É chats (–≤—Å–µ —á–∞—Ç—ã)...")
    # try:
    #     cur.execute("DELETE FROM chats;")
    # except Exception as e:
    #     print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ—á–∏—Å—Ç–∏—Ç—å chats: {e}")

    print("üîÅ –ü—ã—Ç–∞—é—Å—å —Å–±—Ä–æ—Å–∏—Ç—å –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç ID –¥–ª—è operations...")
    try:
        cur.execute("DELETE FROM sqlite_sequence WHERE name = 'operations';")
    except Exception as e:
        print(f"‚ÑπÔ∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–±—Ä–æ—Å–∏—Ç—å –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ): {e}")

    conn.commit()
    conn.close()

    print("‚úÖ –ì–æ—Ç–æ–≤–æ: –æ–ø–µ—Ä–∞—Ü–∏–∏ —É–¥–∞–ª–µ–Ω—ã, –±–∞–ª–∞–Ω—Å—ã –æ–±–Ω—É–ª–µ–Ω—ã.")


if __name__ == "__main__":
    reset_db()
